---
title: "Dustbunnies"
author: "Benjamin Nutter"
date: "`r Sys.Date()`"
output:
  rmarkdown::html_vignette:
    fig_caption: no
    number_section: yes
    toc: yes
vignette: >
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteIndexEntry{Dustbunnies}
  \usepackage[utf8]{inputenc}
---

Dustbunnies are used to modify the appearance of a table. The table below shows the currently available and planned dustbunnies (in light green and yellow, respectively) as well as the implementations for the printing methods.

Black indicates that a dust bunny will have no impact on the output for that method.

Red indicates that a dust bunny is not yet functional for that method.

Green indicates that a dust bunny is currently functional for that method.


```{r, echo=FALSE}
Dustbunnies <- read.csv(system.file("dustbunnies.csv", package = "dustpan"),
                        stringsAsFactors=FALSE)
Dustbunnies[,-1] <- lapply(Dustbunnies[-1], stringr::str_trim)
```

```{r, echo=FALSE}
library(dustpan)
red <- "#A50026"
lightgreen <- "#A6DBA0"
green <- "#006837"
yellow <- "#FFFFBF"

x <- dust(Dustbunnies[, -2]) + 
  dust_cell_bg(row = which(Dustbunnies$implemented == ""), 
               colname = "dustbunny", color = yellow) + 
  dust_cell_bg(row = which(Dustbunnies$implemented == "x"),
               colname = "dustbunny", color = lightgreen)
x$body$bg <- ifelse(!is.na(x$body$bg),
                    x$body$bg,
                    ifelse(x$body$value == "",
                           "black",
                           ifelse(x$body$value == "o",
                                  red,
                                  green)))
x$body$value <- ifelse(x$body$value %in% c("x", "o"), "", x$body$value)
  
x + dust_print_method(print_method = "html")

```

```{r, echo=FALSE, eval=FALSE}
#* README Content
knitr::kable(Dustbunnies, align = c("l", rep("c", 5)))

fit <- lm(mpg ~ qsec + factor(am) + wt + factor(gear), data = mtcars)

library(dustpan)
dust(fit) + 
  dust_round(col = 2:4, round = 3) + 
  dust_fn(col = 5, fn = quote(pvalString(value)))+ 
  dust_colnames(term = "Term", 
                estimate = "Estimate", 
                std.error = "SE",
                statistic = "T-statistic", 
                p.value = "P-value")

summary(fit)

library(broom)
tidy(fit)

library(dustpan)
dust(fit)

x <- dust(fit) + 
  dust_round(col = 2:4, round = 3) + 
  dust_fn(col = 5, fn = quote(pvalString(value)))

x

x <- x + 
  dust_bold(colname = c("estimate", "p.value"), 
            row = c(2, 4), 
            set_bold = TRUE) + 
  dust_colnames(term = "Term", 
                estimate = "Estimate", 
                std.error = "SE",
                statistic = "T-statistic", 
                p.value = "P-value")

x
```